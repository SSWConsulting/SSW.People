steps:
- checkout: none
- download: current

- task: ExtractFiles@1
  inputs:
    archiveFilePatterns: $(Pipeline.Workspace)/drop/*.zip

- task: Bash@3
  displayName: 'remove previous employees'
  inputs:
    targetType: 'inline'
    script: 'rm -rf public/previous-employees'

- task: AzureCLI@2
  displayName: 'deploy'
  inputs:
    azureSubscription: 'Visual Studio Enterprise â€“ MPN(76d03a17-20be-4175-bbed-ca6d7819c68f)'
    scriptType: 'bash'
    scriptLocation: 'inlineScript'
    inlineScript: 'az storage blob upload-batch -s public -d \$web/people --account-name testsswpeoplestaging --content-type "text/html; charset=utf-8"'

- task: Bash@3
  displayName: 'check broken links'
  inputs:
    targetType: 'inline'
    script: 'docker run nvhoanganh1909/sswlinkauditor --url  https://testsswpeoplestaging.z6.web.core.windows.net/people/ --token "828ea8af-66c6-4ff5-63c1-9606e3c702d2" --buildId $(Build.BuildNumber)'