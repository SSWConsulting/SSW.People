steps:
  - checkout: none
  - download: current
  
  - task: ExtractFiles@1
    inputs:
      archiveFilePatterns: $(Pipeline.Workspace)/drop/*.zip
      destinationFolder: drop
      
  - task: IISWebAppManagementOnMachineGroup@0
    displayName: 'Ensure IISVirtualDirectory'
    inputs:
      IISDeploymentType: IISVirtualDirectory
      ParentWebsiteNameForVD: '$(websiteName)'
      VirtualPathForVD: /people
      PhysicalPathForVD: '$(physicalPath)'
    continueOnError: true

  - task: IISWebAppDeploymentOnMachineGroup@0
    displayName: 'Deploy People'
    inputs:
      WebSiteName: '$(websiteName)'
      VirtualApplication: /people
      Package: '$(System.DefaultWorkingDirectory)/**/public.zip'
      RemoveAdditionalFilesFlag: true
